<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>G·ªçi B·ªánh Nh√¢n - Xu√¢n Tr∆∞·ªùng</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #fdfdfd; margin: 20px; text-align: center; }
    h1 { background-color: #ffe066; padding: 15px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); font-size: 26px; }
    .button-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 30px; }
    
    /* N√öT XANH CHU·∫®N */
    button.audio-btn { 
      width: 130px; height: 50px; background-color: #4CAF50; color: white; 
      font-size: 14px; font-weight: bold; border: 2px solid #2e7d32; border-radius: 10px; 
      cursor: pointer; transition: all 0.2s; 
    }
    button.audio-btn:hover { background-color: #45a049; transform: scale(1.05); }
    button.audio-btn:active { transform: scale(0.9); }

    /* M√ÄU ƒê·ªé KHI ƒê√É ƒê∆Ø·ª¢C G·ªåI */
    button.audio-btn.active { 
      background-color: #d32f2f !important; 
      border-color: #b71c1c !important; 
      box-shadow: inset 0 3px 5px rgba(0,0,0,0.3) !important;
    }

    .reset-btn { position: fixed; bottom: 20px; right: 20px; padding: 12px 20px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; z-index: 999; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .tts-container { margin-top: 30px; padding: 20px; background: #eee; border-radius: 15px; display: inline-block; width: 80%; }
    .tts-input { padding: 10px; width: 60%; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
  </style>
</head>
<body>

  <h1>üè• H·ªÜ TH·ªêNG G·ªåI B·ªÜNH NH√ÇN XU√ÇN TR∆Ø·ªúNG</h1>

  <div class="button-container" id="buttonContainer"></div>

  <div class="tts-container">
    <h3>G·ªçi t·ª± do (G√µ t√™n ho·∫∑c s·ªë)</h3>
    <input type="text" id="ttsInput" class="tts-input" placeholder="V√≠ d·ª•: M·ªùi b·ªánh nh√¢n s·ªë 500">
    <button onclick="playTTS()" style="padding: 11px 20px; background: #ff9800; color: white; border-radius: 8px; border: none; cursor: pointer; font-weight: bold;">PH√ÅT LOA</button>
  </div>

  <button class="reset-btn" onclick="resetAll()">üîÑ L√ÄM M·ªöI DANH S√ÅCH</button>
  <audio id="audioPlayer" style="display:none;"></audio>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getDatabase, ref, set, onValue, remove } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA0n0eH-9YOeqmNhQZQooc_wmbQhq9j718",
      authDomain: "ung-dung-y-te-8289b.firebaseapp.com",
      databaseURL: "https://ung-dung-y-te-8289b-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "ung-dung-y-te-8289b",
      appId: "1:291727072122:web:7109ad07009512337214c3"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // DANH S√ÅCH ƒê·∫¶Y ƒê·ª¶ 90 N√öT C·ª¶A ƒê·∫†I CA
    const links = [
      "1-2", "3-4", "5-6", "7-8", "9-10", "11-12", "13-14", "15-16", "17-18", "19-20",
      "21-22", "23-24", "25-26", "27-28", "29-30", "31-32", "33-34", "35-36", "37-38", "39-40",
      "41-42", "43-44", "45-46", "47-48", "49-50", "51-52-53", "54-55-56", "57-58-59", "60-61-62", "63-64-65",
      "66-67-68", "69-70-71", "72-73-74", "75-76-77", "78-79-80", "81-82-83", "84-85-86", "87-88-89", "90-91-92", "93-94-95",
      "96-97-98", "99-100-101", "102-103-104", "105-106-107", "108-109-110", "111-112-113", "114-115-116", "117-118-119", "120-121-122", "123-124-125",
      "126-127-128", "129-130-131", "132-133-134", "135-136-137", "138-139-140", "141-142-143", "144-145-146", "147-148-149", "150-151-152", "153-154-155",
      "156-157-158", "159-160-161", "162-163-164", "165-166-167", "168-169-170", "171-172-173", "174-175-176", "177-178-179", "180-181-182", "183-184-185",
      "186-187-188", "189-190-191", "192-193-194", "195-196-197", "198-199-200", "201-202-203", "204-205-206", "207-208-209", "210-211-212", "213-214-215",
      "216-217-218", "219-220-221", "222-223-224", "224-226-227", "228-229-230", "231-232-233", "234-235-236", "237-238-239", "240-241-242", "243-244-245"
    ];

    const container = document.getElementById("buttonContainer");
    const audio = document.getElementById("audioPlayer");
    const d = new Date();
    const todayKey = `${d.getDate()}-${d.getMonth()+1}-${d.getFullYear()}`;
    const statusPath = `buttonStatus/${todayKey}`;

    links.forEach(name => {
      const btn = document.createElement("button");
      btn.textContent = name;
      btn.className = "audio-btn";
      
      const btnRef = ref(db, `${statusPath}/${name}`);

      onValue(btnRef, (snapshot) => {
        if (snapshot.val() === true) btn.classList.add("active");
        else btn.classList.remove("active");
      });

      btn.onclick = () => {
        audio.src = `https://ttytgt-creatorvinhpham.github.io/ungdungyte/audio_xt/${name}.mp3`;
        audio.play().catch(() => {
          audio.src = `https://ttytgt-creatorvinhpham.github.io/ungdungyte/audio_xt/${name}.MP3`;
          audio.play().catch(() => console.log("L·ªói nh·∫°c"));
        });
        set(btnRef, true);
      };
      container.appendChild(btn);
    });

    window.resetAll = () => confirm("L√†m m·ªõi danh s√°ch?") && remove(ref(db, statusPath));
    window.playTTS = () => {
      const txt = document.getElementById("ttsInput").value;
      if (!txt) return;
      audio.src = `https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&q=${encodeURIComponent(txt)}&tl=vi`;
      audio.play();
    };
  </script>
</body>
</html>
